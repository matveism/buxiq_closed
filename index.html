<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="https://i.imgur.com/2cMurbI.png"/>
<title>Bux iQ</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        primary: '#3b82f6',
        secondary: '#10b981',
        dark: '#0f172a',
        darker: '#020617',
        card: '#1e293b',
        accent: '#f59e0b',
      }
    }
  }
}
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
/* Custom scrollbar styles */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}
::-webkit-scrollbar-track {
  background: #1e293b;
}
::-webkit-scrollbar-thumb {
  background: #3b82f6;
  border-radius: 3px;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: #3b82f6 #1e293b;
}
</style>
</head>
<body class="bg-dark text-white font-sans min-h-screen pb-16 md:pb-0">
<div class="max-w-7xl mx-auto p-4">
<!-- HEADER -->
<header class="flex flex-col md:flex-row items-center justify-between gap-4 mb-8">
  <div class="flex items-center justify-center h-5">
    <img src="https://i.imgur.com/UdEuixj.png" alt="Logo" class="h-20 object-contain" />
  </div>

  <!-- User Profile with Level Indicator -->
  <div class="relative group hidden md:block">
    <div class="flex items-center space-x-3 bg-card rounded-xl px-4 py-2 cursor-pointer hover:bg-opacity-80 transition-all">
      <div class="relative">
        <img id="useravatar" src="https://ui-avatars.com/api/?background=c31432&color=fff&name=User" alt="User Avatar" class="w-12 h-12 rounded-full avatar" />
      </div>
      <div>
        <p id="account" class="font-semibold">N/A</p>
        <p class="text-xs text-gray-400"></p>
      </div>
    </div>
  </div>

  <!-- Balance Indicators -->
  <div class="flex flex-wrap gap-3 hidden md:flex">
    <div class="bg-gradient-to-r from-primary to-blue-600 px-4 py-2 rounded-xl flex items-center">
      <i class="fas fa-coins mr-2 text-yellow-300"></i>
      <div>
        <p class="text-xs text-gray-300">Balance</p>
        <p id="balance" class="font-bold">0.00</p>
      </div>
    </div>
    <div class="bg-gradient-to-r from-secondary to-green-600 px-4 py-2 rounded-xl flex items-center">
      <i class="fas fa-bolt mr-2 text-yellow-300"></i>
      <div>
        <p class="text-xs text-gray-300">Level</p>
        <p id="level" class="font-bold">0.00</p>
      </div>
    </div>
  </div>
</header>

<!-- Desktop NavBar -->
<nav class="hidden md:flex justify-between md:justify-start md:space-x-6 bg-card p-2 rounded-xl mb-6 text-center text-sm">
  <a href="#" data-section="earn" class="nav-link px-6 py-3 rounded-lg bg-primary font-medium flex items-center">
    <i class="fas fa-home mr-2"></i> Home
  </a>
  <a href="#" data-section="shop" class="nav-link px-6 py-3 rounded-lg hover:bg-gray-700 flex items-center transition">
    <i class="fas fa-shopping-bag mr-2"></i> Shop
  </a>
  <a href="#" data-section="leaders" class="nav-link px-6 py-3 rounded-lg hover:bg-gray-700 flex items-center transition">
    <i class="fas fa-trophy mr-2"></i> Leaders
  </a>
  <a href="#" data-section="profile" class="nav-link px-6 py-3 rounded-lg hover:bg-gray-700 flex items-center transition">
    <i class="fas fa-money-bill-wave mr-2"></i> Earn
  </a>
  <a href="#" data-section="help" class="nav-link px-6 py-3 rounded-lg hover:bg-gray-700 flex items-center transition">
    <i class="fas fa-question-circle mr-2"></i> Help
  </a>
  <a href="#" data-section="chat" class="nav-link px-6 py-3 rounded-lg hover:bg-gray-700 flex items-center transition">
    <i class="fas fa-comments mr-2"></i> Chat
  </a>
</nav>

<!-- Mobile User Info Bar -->
<div class="md:hidden flex items-center justify-between bg-card p-3 rounded-xl mb-4">
  <div class="flex items-center space-x-3">
    <div class="relative">
      <img id="mobileUseravatar" src="https://ui-avatars.com/api/?background=c31432&color=fff&name=User" alt="User Avatar" class="w-12 h-12 rounded-full avatar" />
    </div>
    <div>
      <p id="usernameDisplay" class="font-semibold">N/A</p>
      <p class="text-xs text-gray-400"></p>
    </div>
  </div>
  <div class="flex space-x-2">
    <div class="bg-gradient-to-r from-primary to-blue-600 px-3 py-1 rounded-lg flex items-center">
      <i class="fas fa-coins text-yellow-300 text-sm"></i>
      <span id="mobileBalance" class="ml-1 text-sm font-medium">0.00</span>
    </div>
    <div class="bg-gradient-to-r from-secondary to-green-600 px-3 py-1 rounded-lg flex items-center">
      <i class="fas fa-bolt text-yellow-300 text-sm"></i>
      <span id="mobileLevel" class="ml-1 text-sm font-medium">0.00</span>
    </div>
  </div>
</div>

<!-- PAGE SECTIONS -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen p-6">
    <div class="max-w-4xl mx-auto space-y-6">
        <!-- Rectangular Earn Money Card -->
        <div id="section-earn" class="bg-gradient-to-r from-indigo-900 to-purple-900 rounded-xl p-6 shadow-lg border border-gray-700">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold">Earn Money</h2>
                    <p class="text-indigo-200 mt-1">Complete tasks and earn rewards</p>
                </div>
                <button class="mt-4 md:mt-0 px-6 py-2 bg-white text-indigo-900 hover:bg-indigo-100 rounded-lg font-medium transition-colors">
                    Start Earning
                </button>
            </div>
        </div>

        <!-- Activity Logs Section -->
        <div class="bg-gray-800/80 backdrop-blur-sm rounded-xl border border-gray-700 p-6">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-4">
                    <h1 class="text-2xl font-bold text-white">Recent Activity</h1>
                    <span class="h-5 w-px bg-gray-500 opacity-60"></span>
                </div>
                <button onclick="fetchCSV()" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    Refresh
                </button>
            </div>

            <div id="logs" class="max-h-25 overflow-y-auto space-y-3">
                <!-- Placeholder while loading -->
                <div class="h-64 flex items-center justify-center">
                    <div class="text-center text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto mb-3 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        <p>Loading activity logs...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

    <script>
        // Recent Activity Logs
        async function fetchCSV() {
            try {
                const logsContainer = document.getElementById('logs').querySelector('div');
                logsContainer.innerHTML = `
                    <div class="h-64 flex items-center justify-center">
                        <div class="text-center text-gray-400">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto mb-3 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                            <p>Loading activity logs...</p>
                        </div>
                    </div>
                `;

                const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3p3daAnCETfJtrUUvaiNqoUreYkn9FIHus6rEyq-e8E8oLaV51L_NrVWjHp1CyTv3UqBqryq3aH-0/pub?gid=0&single=true&output=csv');
                if (!response.ok) throw new Error('Failed to fetch logs: ' + response.statusText);

                const data = await response.text();
                const rows = data.split('\n').slice(1); // Skip header row

                if (rows.length === 0) {
                    logsContainer.innerHTML = '<div class="h-64 flex items-center justify-center text-gray-400 font-medium"><p>No activity logs found.</p></div>';
                    return;
                }

                logsContainer.innerHTML = '';
                let hasValidEntries = false;

                rows.forEach((row, index) => {
                    const columns = row.split(',').map(item => item.trim());
                    if (columns.length >= 7 && columns[2] && columns[6]) {
                        hasValidEntries = true;
                        const username = columns[2];
                        const amount = columns[6];
                        const timestamp = columns[0] || 'Recently';
                        const offerName = columns[3] || 'Offer completed';

                        const colors = ['bg-indigo-600', 'bg-pink-600', 'bg-emerald-600', 'bg-amber-600', 'bg-purple-600'];
                        const randomColor = colors[username.charCodeAt(0) % colors.length];

                        const logEntry = document.createElement('div');
                        logEntry.className = `animate-fade-in opacity-0 flex items-center justify-between p-4 hover:bg-gray-700/50 rounded-lg transition-colors duration-200`;
                        logEntry.style.animationDelay = `${index * 50}ms`;
                        logEntry.innerHTML = `
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 flex items-center justify-center ${randomColor} rounded-full text-white font-bold">
                                    ${username.charAt(0).toUpperCase()}
                                </div>
                                <div>
                                    <div class="font-medium text-white">${username}</div>
                                    <div class="text-xs text-gray-400">${offerName} â€¢ ${timestamp}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-semibold text-green-400">+${amount}</div>
                                <div class="text-xs text-gray-400">Completed</div>
                            </div>
                        `;

                        logsContainer.prepend(logEntry);
                    }
                });

                if (!hasValidEntries) {
                    logsContainer.innerHTML = '<div class="h-64 flex items-center justify-center text-gray-400 font-medium"><p>No valid activity entries found.</p></div>';
                }

            } catch (error) {
                console.error('Error fetching activity logs:', error);
                const logsContainer = document.getElementById('logs').querySelector('div');
                logsContainer.innerHTML = `
                    <div class="h-64 flex flex-col items-center justify-center text-red-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <p class="font-medium">Error loading activity logs</p>
                        <p class="text-xs text-gray-500 mt-1">${error.message}</p>
                    </div>
                `;
            }
        }

        // Initial load
        document.addEventListener('DOMContentLoaded', fetchCSV);

        // Add animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(5px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in {
                animation: fadeIn 0.3s ease-out forwards;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
  <div class="bg-card rounded-xl p-4 mb-6">
    <div class="flex flex-col md:flex-row items-center">
      <div class="bg-gradient-to-r from-primary to-blue-600 p-3 rounded-lg mb-3 md:mb-0 md:mr-4">
        <i class="fas fa-users text-white text-xl"></i>
      </div>
      <div class="text-center md:text-left flex-grow">
        <h3 class="font-bold">Join our Discord Community</h3>
        <p class="text-sm text-gray-400">Get access to exclusive giveaways and level-specific promocodes</p>
      </div>
      <button class="mt-3 md:mt-0 bg-gradient-to-r from-purple-500 to-pink-500 hover:opacity-90 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
        Join Now
      </button>
    </div>
  </div>
  <!-- Offers Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="offers-grid">
    <!-- Offer cards will be here -->
    <!-- Example: -->
    <div class="bg-card rounded-xl overflow-hidden hover:shadow-lg hover:-translate-y-1 transition-all duration-300 border border-gray-700">
      <div class="bg-gradient-to-r from-yellow-400 to-yellow-600 p-4 flex justify-center">
        <img src="https://via.placeholder.com/150x60?text=NTIK+ME" alt="NTIK ME" class="h-12 object-contain" />
      </div>
      <div class="p-4">
        <h3 class="font-bold mb-2">NTIK ME Surveys</h3>
        <p class="text-sm text-gray-400 mb-3">Complete surveys and earn up to $5.00 per survey</p>
        <div class="flex justify-between items-center">
          <span class="text-xs bg-gray-700 px-2 py-1 rounded flex items-center">
            <i class="fas fa-star text-yellow-400 mr-1"></i> 4.8
          </span>
          <span class="text-xs bg-gray-700 px-2 py-1 rounded">Avg: $1.50</span>
          <button class="bg-primary hover:bg-blue-600 text-white px-3 py-1 rounded text-sm font-medium transition">
            Start
          </button>
        </div>
      </div>
    </div>
    <!-- Add more offer cards as needed -->
    <!-- Repeat similar structure for other offer cards -->
  </div>
</section>

<!-- Shop Section -->
<section id="section-shop" class="hidden">
  <h2 class="text-2xl font-bold mb-6">Shop Rewards</h2>
  <div class="bg-card rounded-xl p-6 text-center">
    <p class="text-gray-400 mb-2">Browse and redeem your points for gift cards and prizes.</p>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-4">
      <div class="bg-gradient-to-r from-yellow-500 to-yellow-700 rounded-lg p-4 flex flex-col items-center">
        <i class="fas fa-gift text-3xl mb-2"></i>
        <span class="font-bold">Amazon Gift Card</span>
        <span class="text-sm text-gray-200 mt-1">From $5</span>
        <button class="mt-3 bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
          Redeem
        </button>
      </div>
      <div class="bg-gradient-to-r from-blue-500 to-blue-700 rounded-lg p-4 flex flex-col items-center">
        <i class="fas fa-gamepad text-3xl mb-2"></i>
        <span class="font-bold">Steam Wallet</span>
        <span class="text-sm text-gray-200 mt-1">From $5</span>
        <button class="mt-3 bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
          Redeem
        </button>
      </div>
      <div class="bg-gradient-to-r from-green-500 to-green-700 rounded-lg p-4 flex flex-col items-center">
        <i class="fas fa-credit-card text-3xl mb-2"></i>
        <span class="font-bold">PayPal Cash</span>
        <span class="text-sm text-gray-200 mt-1">From $5</span>
        <button class="mt-3 bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
          Redeem
        </button>
      </div>
    </div>
  </div>
</section>

<!-- Leaders Section -->
<section id="section-leaders" class="hidden">
<h2 class="text-2xl font-bold mb-6">Leaderboard</h2>
<div class="bg-card rounded-xl p-6">
  <table class="w-full text-left">
    <thead>
      <tr>
        <th class="py-2 px-4">Rank</th>
        <th class="py-2 px-4">User</th>
        <th class="py-2 px-4">Points</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="py-2 px-4 font-bold">1</td>
        <td class="py-2 px-4">Georgia Mills</td>
        <td class="py-2 px-4">12,000</td>
      </tr>
      <tr>
        <td class="py-2 px-4 font-bold">2</td>
        <td class="py-2 px-4">Alex Carter</td>
        <td class="py-2 px-4">10,500</td>
      </tr>
      <tr>
        <td class="py-2 px-4 font-bold">3</td>
        <td class="py-2 px-4">Jamie Lee</td>
        <td class="py-2 px-4">9,800</td>
      </tr>
    </tbody>
  </table>
</div>
</section>

<!-- Profile Section -->
<section id="section-profile" class="hidden">
<h2 class="text-2xl font-bold mb-6">Your Profile</h2>
<div class="bg-card rounded-xl p-6 flex flex-col md:flex-row items-center gap-6">
  <div class="flex flex-col gap-4 w-full">
    <!-- User Dashboard Section (Login/Dashboard) -->
    <div id="userdash" class="section">
      <!-- Login Container -->
      <div id="login-container" class="card p-8 max-w-md mx-auto">
        <div class="flex justify-center mb-6"></div>
        <h2 class="text-2xl font-bold text-center font-space mb-6 gradient-text">LOGIN</h2>
        <form id="loginForm" class="space-y-6 max-w-md mx-auto p-8 bg-gradient-to-br from-gray-900/70 to-gray-800/70 rounded-2xl shadow-lg backdrop-blur-md">
          <div>
            <label for="login-account" class="block text-sm font-semibold text-gray-300 mb-2">Account #</label>
            <input id="login-account" type="text" required placeholder="Enter your account number"
              class="w-full px-4 py-3 rounded-lg bg-gray-700 bg-opacity-40 border border-transparent focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-100 placeholder-gray-400 transition" />
          </div>
          <div>
            <label for="login-clientid" class="block text-sm font-semibold text-gray-300 mb-2">Client ID</label>
            <input id="login-clientid" type="text" required placeholder="Enter your client ID"
              class="w-full px-4 py-3 rounded-lg bg-gray-700 bg-opacity-40 border border-transparent focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-gray-100 placeholder-gray-400 transition" />
          </div>
          <div>
            <div id="captcha" 
              class="select-none text-center text-yellow-400 font-mono text-xl tracking-widest mb-2 rounded-lg bg-gray-700 bg-opacity-50 py-2 shadow-inner">
              25441
            </div>
            <input id="captchaInput" type="text" required placeholder="Enter CAPTCHA"
              class="w-full px-4 py-3 rounded-lg bg-gray-700 bg-opacity-40 border border-transparent focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 text-gray-100 placeholder-yellow-300 transition" />
          </div>
          <button type="submit"
            class="w-full py-3 rounded-lg bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-purple-600 hover:to-indigo-500 text-white font-semibold flex items-center justify-center gap-2 shadow-lg transition-transform active:scale-95">
            <span class="">login</span> Login
          </button>
        </form>
        <div id="error-msg" class="text-center text-red-400 mt-4 hidden"></div>
      </div>
      
      <!-- Dashboard (Visible After Login) -->
      <div id="dashboard" class="hidden max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-sm bg-opacity-90 border border-gray-700/50">
          <div class="p-8">
            <div class="text-center mb-10">
              <h2 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-blue-500 tracking-tight">
                EARNING PORTAL
              </h2>
              <p class="mt-2 text-gray-400 font-light">Complete offers and surveys to earn rewards</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
              <!-- Example Offer -->
              <div class="bg-gray-800/50 hover:bg-gray-700/50 transition-all duration-300 rounded-xl p-5 border border-gray-700 hover:border-cyan-400/30 group relative overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-br from-cyan-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                <div class="relative z-10">
                  <div class="flex justify-center py-3">
                    <img src="https://www.cpx-research.com/main/en/assets/img/logo.svg" alt="CPX Research Logo" class="h-10 object-contain filter brightness-0 invert opacity-90 group-hover:opacity-100 transition-opacity" />
                  </div>
                  <button id="openOfferWallCPX" class="mt-4 w-full bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white font-medium py-2.5 px-4 rounded-lg transition-all duration-200 transform hover:scale-[1.02] shadow-lg hover:shadow-cyan-500/20">
                    Open OfferWall
                  </button>
                </div>
              </div>
              <!-- Add other offerwall buttons similarly -->
              <!-- ... -->
            </div>
            <div class="mt-12 text-center">
              <button onclick="logout()" class="px-6 py-2.5 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded-lg font-medium transition-all duration-200 border border-gray-600 hover:border-gray-500 shadow hover:shadow-lg">
                Logout
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<!-- Help Section -->
<section id="section-help" class="hidden">
<h2 class="text-2xl font-bold mb-6">Help & Support</h2>
<div class="bg-card rounded-xl p-6">
  <h3 class="font-semibold mb-2">Frequently Asked Questions</h3>
  <ul class="list-disc ml-6 text-gray-300">
    <li>How do I earn points?</li>
    <li>How can I redeem rewards?</li>
    <li>Who do I contact for support?</li>
  </ul>
  <button class="mt-6 bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition">
    Contact Support
  </button>
</div>
</section>

<!-- Chat Section -->
<section id="section-chat" class="hidden">
<h2 class="text-2xl font-bold mb-6">Community Chat</h2>
<div class="bg-card rounded-xl p-6">
  <p class="mb-4 text-gray-400">Join the conversation with other members!</p>
  <div class="bg-gray-800 rounded-lg p-4 h-48 overflow-y-auto mb-4" id="chat-log">
    <!-- Chat messages here -->
  </div>
  <div class="flex">
    <input type="text" class="flex-grow rounded-l-lg bg-gray-700 px-4 py-2 focus:outline-none" placeholder="Type your message..." id="chat-input" />
    <button class="bg-primary hover:bg-blue-600 text-white px-4 py-2 rounded-r-lg font-medium transition" id="send-chat">Send</button>
  </div>
</div>
</section>

<!-- Bottom Navigation for Mobile -->
<div class="fixed bottom-0 left-0 right-0 bg-card border-t border-gray-700 shadow-lg md:hidden z-50">
  <div class="flex justify-around">
    <a href="#" data-section="earn" class="nav-link-mobile flex flex-col items-center justify-center p-3 text-primary" data-section="earn">
      <i class="fas fa-home text-xl"></i>
      <span class="text-xs mt-1">Home</span>
    </a>
    <a href="#" data-section="shop" class="nav-link-mobile flex flex-col items-center justify-center p-3 text-gray-400" data-section="shop">
      <i class="fas fa-shopping-bag text-xl"></i>
      <span class="text-xs mt-1">Shop</span>
    </a>
    <a href="#" data-section="leaders" class="nav-link-mobile flex flex-col items-center justify-center p-3 text-gray-400" data-section="leaders">
      <i class="fas fa-trophy text-xl"></i>
      <span class="text-xs mt-1">Leaders</span>
    </a>
    <a href="#" data-section="profile" class="nav-link-mobile flex flex-col items-center justify-center p-3 text-gray-400" data-section="profile">
      <i class="fas fa-money-bill-wave text-xl"></i>
      <span class="text-xs mt-1">Earn</span>
    </a>
    <a href="#" data-section="help" class="nav-link-mobile flex flex-col items-center justify-center p-3 text-gray-400" data-section="help">
      <i class="fas fa-question-circle text-xl"></i>
      <span class="text-xs mt-1">Help</span>
    </a>
    <a href="#" data-section="chat" class="nav-link-mobile flex flex-col items-center justify-center p-3 text-gray-400" data-section="chat">
      <i class="fas fa-comments text-xl"></i>
      <span class="text-xs mt-1">Chat</span>
    </a>
  </div>
</div>

<!-- Hidden iframe container for offerwalls -->
<div id="iframeContainer" class="fixed inset-0 bg-black bg-opacity-70 hidden z-50">
  <div class="relative w-full h-full p-4">
    <button onclick="closeIframe()" class="absolute top-4 right-4 bg-red-600 text-white px-4 py-2 rounded z-50">Close</button>
    <iframe id="dashboardIframe" class="w-full h-full rounded-lg" src="" frameborder="0"></iframe>
  </div>
</div>

<script>
// Navigation handler
function showSection(section) {
  const sections = ['earn', 'shop', 'leaders', 'profile', 'help', 'chat'];
  sections.forEach(sec => {
    document.getElementById('section-' + sec).classList.toggle('hidden', sec !== section);
  });
  // Highlight desktop nav links
  document.querySelectorAll('.nav-link').forEach(link => {
    link.classList.toggle('bg-primary', link.dataset.section === section);
    link.classList.toggle('text-white', link.dataset.section === section);
    if (link.dataset.section === section) {
      link.classList.remove('hover:bg-gray-700', 'text-gray-400');
    } else {
      link.classList.add('hover:bg-gray-700', 'text-gray-400');
    }
  });
  // Highlight mobile nav links
  document.querySelectorAll('.nav-link-mobile').forEach(link => {
    link.classList.toggle('text-primary', link.dataset.section === section);
    link.classList.toggle('text-gray-400', link.dataset.section !== section);
  });
}

// Generate Captcha
let captchaCode = '';

function generateCaptcha() {
  captchaCode = Math.floor(10000 + Math.random() * 90000).toString();
  const captchaEl = document.getElementById('captcha');
  if (captchaEl) {
    captchaEl.textContent = 'Enter: ' + captchaCode;
  }
  return captchaCode;
}

// Logout
function logout() {
  document.getElementById('dashboard').classList.add('hidden');
  document.getElementById('login-container').classList.remove('hidden');
  document.getElementById('account').value = '';
  document.getElementById('clientid').value = '';
  document.getElementById('captchaInput').value = '';
  document.getElementById('error-msg').classList.add('hidden');
  generateCaptcha();
}

// Event listeners for navigation
document.querySelectorAll('.nav-link, .nav-link-mobile').forEach(link => {
  link.addEventListener('click', e => {
    e.preventDefault();
    showSection(link.dataset.section);
  });
});

// Login form handler
const loginForm = document.getElementById('loginForm');
if (loginForm) {
  loginForm.addEventListener('submit', async e => {
    e.preventDefault();
    const account = document.getElementById('login-account').value.trim();
    const clientid = document.getElementById('login-clientid').value.trim();
    const captchaInput = document.getElementById('captchaInput').value.trim();
    const errorMsg = document.getElementById('error-msg');

    if (captchaInput !== captchaCode) {
      if (errorMsg) {
        errorMsg.textContent = 'Invalid CAPTCHA';
        errorMsg.classList.remove('hidden');
      } else {
        alert('Invalid CAPTCHA');
      }
      generateCaptcha();
      document.getElementById('captchaInput').value = '';
      return;
    }

    try {
      const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
      if (!response.ok) throw new Error('Network response was not ok');
      const data = await response.text();
      const rows = data.trim().split('\n').map(row => row.split(','));
      // Assume structure: Account#, ClientID, Status, Balance, Username, Avatar URL, Level
      const user = rows.find(r => r[0] === account && r[1] === clientid);
      if (user) {
        const status = (user[2] || '').toLowerCase();
        if (status === 'blocked') {
          if (errorMsg) {
            errorMsg.textContent = 'Your account is blocked.';
            errorMsg.classList.remove('hidden');
          } else {
            alert('Your account is blocked.');
          }
          document.getElementById('login-account').value = '';
          document.getElementById('login-clientid').value = '';
          document.getElementById('captchaInput').value = '';
          generateCaptcha();
          return;
        }

        // Update UI
        const avatarUrl = user[5] || `https://ui-avatars.com/api/?background=c31432&color=fff&name=${encodeURIComponent(user[4] || 'User')}`;
        document.getElementById('useravatar').src = avatarUrl;
        document.getElementById('mobileUseravatar').src = avatarUrl;
        document.getElementById('level').textContent = user[6] || '1';
        document.getElementById('level').textContent = user[6] || '1';

        document.getElementById('balance').innerHTML = `<span class="currency">$</span> ${user[3] || '0.00'}`;
        document.getElementById('mobileBalance').innerHTML = `<span class="material-symbols-rounded text-green-400 mr-1">savings</span> $${user[3] || '0.00'}`;
        document.getElementById('account').textContent = user[4] || 'User';

        // Store in local storage if needed
        localStorage.setItem('buxiq_account', account);

        // Show dashboard
        document.getElementById('login-container').classList.add('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
        if (errorMsg) errorMsg.classList.add('hidden');
      } else {
        if (errorMsg) {
          errorMsg.textContent = 'Invalid credentials';
          errorMsg.classList.remove('hidden');
        } else {
          alert('Invalid credentials');
        }
        document.getElementById('captchaInput').value = '';
        generateCaptcha();
      }
    } catch (err) {
      console.error('Fetch error:', err);
      if (errorMsg) {
        errorMsg.textContent = 'Error loading data.';
        errorMsg.classList.remove('hidden');
      }
      document.getElementById('captchaInput').value = '';
      generateCaptcha();
    }
  });
}

// Offerwall Iframes
        function openIframe(url) {
            const iframeContainer = document.getElementById('iframeContainer');
            const dashboardIframe = document.getElementById('dashboardIframe');
            if (iframeContainer && dashboardIframe) {
                dashboardIframe.src = url;
                iframeContainer.classList.remove('hidden');
            } else {
                 console.warn("Iframe elements not found.");
            }
        }

        function closeIframe() {
            const iframeContainer = document.getElementById('iframeContainer');
            const dashboardIframe = document.getElementById('dashboardIframe');
             if (iframeContainer && dashboardIframe) {
                iframeContainer.classList.add('hidden');
                dashboardIframe.src = ''; // Clear the iframe source
             }
        }

        // Attach listeners to Offerwall buttons
        const offerwallButtons = {
            'openOfferWallCPX': (user) => `https://offers.cpx-research.com/index.php?app_id=26219&ext_user_id=${user}&username=${user}&subid_1=&subid_2`,
            'openOfferWallsads': (user) => `https://offerwall.sushiads.com/surveywall?apiKey=67e76c74ca62f460071524&userId=${user}`,
            'openOfferWallchat': () => `https://bux-iq.netlify.app/chat.html`, // Does not use user ID
            'openOfferWallwannads': (user) => `https://earn.wannads.com/wall?apiKey=67d3d43d63631681386947&userId=${user}`,
            'openOfferWallsads1': (user) => `https://offerwall.sushiads.com/wall?apiKey=67e76c74ca62f460071524&userId=${user}`,
            'openOfferWallExcentiv': (user) => `https://excentiv.com/offerwall/?&userid=${user}&key=q1v8KGQfCjmNeXnhsHyo`,
            'openOfferWallbuxiq': () => `https://bux-iq.netlify.app/cashout.html`, // Does not use user ID
            'openOfferWallbuxiqbonus': () => `https://bux-iq.netlify.app/bonus.html`, // Does not use user ID
            'openOfferWallkiwi': (user) => `https://www.kiwiwall.com/wall/ICKEzWAlZv8O6QOXSxFdfJ7jLfU6RUtl/${user}`,
            'openOfferWalltaskwall': (user) => `https://wall.taskwall.io/?app_id=532d75c281c9725adc821ff7de18c199&userid=${user}`,
            'openOfferWallporix': (user) => `https://porix.org/app/iframe/10221/${user}`
        };

        Object.keys(offerwallButtons).forEach(buttonId => {
            const button = document.getElementById(buttonId);
            if (button) {
                button.addEventListener('click', function() {
                    const userAccount = document.getElementById('account').value.trim(); // Get account number from login form
                    const urlGenerator = offerwallButtons[buttonId];
                    const url = urlGenerator(userAccount); // Pass user account if needed
                    openIframe(url);
                });
            } else {
                 console.warn(`Button with ID '${buttonId}' not found.`);
            }
        });


// Update balance function
async function updateBalance() {
  const account = document.getElementById('account').value.trim();
  const clientid = document.getElementById('clientid').value.trim();
  if (!account || !clientid) return;

  try {
    const response = await fetch('https://docs.google.com/spreadsheets/d/e/your_spreadsheet_url/pub?gid=0&single=true&output=csv');
    if (!response.ok) throw new Error('Network error');
    const data = await response.text();
    const rows = data.trim().split('\n').map(r => r.split(','));
    const user = rows.find(r => r[0] === account && r[1] === clientid);
    if (user) {
      document.getElementById('balance').innerHTML = `<span class="currency">$</span> ${user[3] || '0.00'}`;
      document.getElementById('mobileBalance').innerHTML = `<span class="material-symbols-rounded text-green-400 mr-1">savings</span> $${user[3] || '0.00'}`;
    } else {
      document.getElementById('balance').innerHTML = `<span class="currency">$</span> 0.00`;
      document.getElementById('mobileBalance').innerHTML = `<span class="material-symbols-rounded text-green-400 mr-1">savings</span> $0.00`;
    }
  } catch (err) {
    console.error(err);
  }
}

// Fetch CSV for activity logs
async function fetchCSV() {
  try {
    const response = await fetch('https://docs.google.com/spreadsheets/d/e/your_logs_spreadsheet_url/pub?gid=0&single=true&output=csv');
    if (!response.ok) throw new Error('Network error');
    const data = await response.text();
    const rows = data.trim().split('\n').slice(1); // skip header
    const logsContainer = document.getElementById('logs')?.querySelector('div');
    if (!logsContainer) return;
    logsContainer.innerHTML = '';

    let hasLogs = false;
    rows.forEach((row, index) => {
      const cols = row.split(',').map(c => c.trim());
      if (cols.length >= 7 && cols[2] && cols[6]) {
        hasLogs = true;
        const username = cols[2];
        const amount = cols[6];
        const logDiv = document.createElement('div');
        logDiv.className = 'flex items-center justify-between p-3 mb-2 bg-white/10 rounded-lg text-sm';
        logDiv.innerHTML = `
          <div class="flex items-center space-x-3">
            <div class="w-8 h-8 flex items-center justify-center bg-red-600 rounded-full text-white">
              <span class="text-sm font-bold">${username.charAt(0).toUpperCase()}</span>
            </div>
            <div>
              <div class="text-sm font-medium text-white">${username}</div>
            </div>
          </div>
          <div class="text-green-400 font-semibold">+${amount}</div>
        `;
        logsContainer.prepend(logDiv);
      }
    });
    if (!hasLogs) {
      logsContainer.innerHTML = '<div class="text-center h-full flex items-center justify-center opacity-70 font-medium"><p>Your activity log will appear here</p></div>';
    }
  } catch (err) {
    console.error(err);
    const logsContainer = document.getElementById('logs')?.querySelector('div');
    if (logsContainer) {
      logsContainer.innerHTML = '<div class="text-center h-full flex items-center justify-center text-red-400 font-medium"><p>Error loading activity logs.</p></div>';
    }
  }
}

// Bonus code redemption
async function redeemBonusCode() {
  const username = document.getElementById('username').value.trim();
  const bonusCode = document.getElementById('bonusCode').value.trim();
  const amountLocalInput = document.getElementById('amountLocal');
  const amountUsdInput = document.getElementById('amountUsd');

  if (!username || !bonusCode) {
    alert('Please fill in all fields');
    return;
  }

  if (amountLocalInput) amountLocalInput.value = '';
  if (amountUsdInput) amountUsdInput.value = '';

  try {
    const response = await fetch(`https://script.google.com/macros/s/your_script_id/exec?username=${encodeURIComponent(username)}&bonusCode=${encodeURIComponent(bonusCode)}`);
    const result = await response.text();
    if (result.includes('Error')) {
      alert(result);
    } else {
      const [amountLocal, amountUsd] = result.split(',');
      if (amountLocalInput) amountLocalInput.value = amountLocal.trim();
      if (amountUsdInput) amountUsdInput.value = amountUsd.trim();
      sendPostback(amountLocal, amountUsd, username, bonusCode);
      alert('Bonus code redeemed successfully!');
    }
  } catch (err) {
    console.error(err);
    alert('Error redeeming bonus code.');
  }
}

// Postback
function sendPostback(amountLocal, amountUsd, username, bonusCode) {
  const timestamp = Date.now();
  const url = `https://script.google.com/macros/s/your_postback_script_id/exec?status=success&trans_id=${timestamp}&user_id=${encodeURIComponent(username)}&bonusCode=${encodeURIComponent(bonusCode)}&amount_local=${encodeURIComponent(amountLocal)}&amount_usd=${encodeURIComponent(amountUsd)}`;
  fetch(url)
    .then(res => res.json())
    .then(data => console.log('Postback:', data))
    .catch(err => console.error('Postback error:', err));
}

// Initialize on DOM load
document.addEventListener('DOMContentLoaded', () => {
  generateCaptcha();

  // Show default section
  showSection('earn');

  // Load activity logs
  fetchCSV();

  // Set up chat send
  document.getElementById('send-chat')?.addEventListener('click', () => {
    const input = document.getElementById('chat-input');
    const log = document.getElementById('chat-log');
    if (input && log && input.value.trim() !== '') {
      const msg = document.createElement('div');
      msg.className = 'mb-2';
      msg.innerHTML = `<span class="font-semibold text-primary">You:</span> ${input.value.trim()}`;
      log.appendChild(msg);
      input.value = '';
      log.scrollTop = log.scrollHeight;
    }
  });
  // Also send on Enter key
  document.getElementById('chat-input')?.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault();
      document.getElementById('send-chat')?.click();
    }
  });
});
// Attach event listeners
Object.keys(offerwallButtons).forEach(id => {
  const btn = document.getElementById(id);
  if (btn) {
    btn.addEventListener('click', () => {
      const url = offerwallButtons[id]();
      openIframe(url);
    });
  }
});
// Show iframe overlay
function openIframe(url) {
  const container = document.getElementById('iframeContainer');
  const iframe = document.getElementById('dashboardIframe');
  if (container && iframe) {
    iframe.src = url;
    container.classList.remove('hidden');
  }
}

// Hide iframe overlay
function closeIframe() {
  const container = document.getElementById('iframeContainer');
  const iframe = document.getElementById('dashboardIframe');
  if (iframe && container) {
    iframe.src = '';
    container.classList.add('hidden');
  }
}

// Make sure to call generateCaptcha() on page load
document.addEventListener('DOMContentLoaded', () => {
  generateCaptcha();
  // Optional: show default section
  showSection('earn');
});

// Attach handlers for offerwall buttons
Object.keys(offerwallButtons).forEach(id => {
  const btn = document.getElementById(id);
  if (btn) {
    btn.addEventListener('click', () => {
      const url = offerwallButtons[id]();
      openIframe(url);
    });
  }
});


</script>
</body>
</html>
